<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const Nightmare = require('nightmare');
const nightmare = Nightmare({ show: true });
const async = require('async');
const until = require('async/until');
const figlet = require('figlet');
const clear = require('clear');
const chalk = require('chalk');
const dateFormat = require('dateFormat');
const inquirer = require('inquirer');
inquirer.registerPrompt('datetime', require('inquirer-datepicker-prompt'));

const url = 'https://apod.nasa.gov/apod/ap';
let start = 0;
let end = 0;

clear();
console.log(
  chalk.blue(
    figlet.textSync('Astronomy\nPicture\nof the\nDay', {
      horizontalLayout: 'default'
    })
  )
);

/**
 * Returns an array of all the dates between two yymmdd formatted dates
 * @ param {string} start - The start date (yymmdd)
 * @ param {string} end - The end date (yymmdd)
 */
function getDates(start, end) {
  let date = Number(start);
  let dates = [];
  let days_in_month = [0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
  end = Number(end);
  dates.push(start);

  async.whilst(
    () => {
      return date &lt; end;
    },
    callback => {
      let year = Number(date.toString().slice(0, 2));
      let day = Number(date.toString().slice(4));
      let month = Number(date.toString().slice(2, 4));

      if (month &lt; 9) {
        // account for leap years
        if (month == 2 &amp;&amp; year % 4 == 0) {
          console.log(dates);
          if (day &lt; 29) {
            date += 1;
          } else {
            month += 1;
            date = Number(year.toString() + '0' + month.toString() + '01');
          }
        } else if (day &lt; days_in_month[month]) {
          date += 1;
          getDates(date, end);
        } else {
          month += 1;
          date = Number(year.toString() + '0' + month.toString() + '01');
        }
        dates.push(date.toString());
      } else if (9 &lt;= month &lt; 12) {
        if (day &lt; days_in_month[month]) {
          date += 1;
        } else {
          month += 1;
          date = Number(year.toString() + '0' + month.toString() + '01');
        }
        dates.push(date.toString());
      } else if (month == 12) {
        if (day &lt; days_in_month[month]) {
          date += 1;
        } else {
          year += 1;
          date = Number(year.toString() + '0101');
        }
        dates.push(date.toString());
      }
      setTimeout(() => {
        callback(null, date);
      }, 100);
    },
    (error, n) => {
      console.log(error, n);
    }
  );
  return dates;
}

console.log(getDates('9602220', '9602221'));

function getApod(date) {
  if (Number(date) &lt;= end) {
    nightmare
      .goto(url + date + '.html')
      .wait(1000)
      .run(() => getApod(Number(date) + 1));
  }
}

function getApodDates() {
  const questions = [
    {
      type: 'datetime',
      name: 'start',
      message: 'Start date:',
      format: ['mm', '/', 'dd', '/', 'yyyy'],
      date: {
        min: '6/20/1995'
      }
    },
    {
      type: 'datetime',
      name: 'end',
      message: 'End date:',
      format: ['mm', '/', 'dd', '/', 'yyyy'],
      date: {
        min: '6/21/1995'
      }
    }
  ];

  inquirer
    .prompt(questions)
    .then(answers => {
      if (
        dateFormat(answers.start, 'yyyymmdd') &lt;
        dateFormat(answers.end, 'yyyymmdd')
      ) {
        start = dateFormat(answers.start, 'yymmdd');
        end = dateFormat(answers.end, 'yymmdd');
        getApod(start);
      } else {
        console.log(
          chalk.red('Make sure your start and end dates are correct')
        );
        return;
      }
    })
    .catch(error => console.error(error));
}

// getApodDates();
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#getDates">getDates</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sun Dec 17 2017 12:19:04 GMT-0500 (EST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
